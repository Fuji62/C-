/*
 ============================================================================
 Name        : gren5.c
 Author      : 藤本智哉
 Version     :
 Copyright   : Your copyright notice
 Description : 会員名簿のデータを構造体の配列に記憶させ、購入一覧表の購入金額
 　　　　　　　を名簿の構造体配列に集計し、出力する。購入していない会員は
 　　　　　　　出力しない。ただし、処理は次の手順で行う。
 　　　　　　　・main関数の中で会員名簿のデータを構造体の中に記憶させる。
 　　　　　　　・構造体の配列を集計処理する関数に引数として渡す。
 　　　　　　　・集計後、main関数に戻り、一覧表を出力する関数に構造体の配列を
 　　　　　　　　渡し、出力処理をする。
============================================================================
 */
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define NUMBER 15 //会員の人数
#define STR_LEN 128
//****************************************************************************
typedef struct{                                           /* 構造体の宣言 */
	int id;
	char name[STR_LEN];
	char kana[STR_LEN];
	int birthday;
	int purchase_price;
}Person;

//****************************************************************************
                                               /* 会員ごとの購入金額の集計 */
void amount_summary(Person member[], int sales_data[2][NUMBER], Person *p){
	for(int i = 0; i < NUMBER; i++){
		for(int j = 0; j < NUMBER; j++){
			if(sales_data[0][i] == (p + j)->id){
				(p + j)->purchase_price += sales_data[1][i];
			}
		}
	}
}
//****************************************************************************
void print_data(Person member[], Person *p){          /*構造体データの出力*/
	printf("購入者の一覧を表示します。\n\n");
	printf("【会員データ】\n");
	printf(" ID　　 氏名　　　　購入金額\n");
	for(int i = 0; i < NUMBER; i++){
		if((p + i)->purchase_price != 0){
			printf(" %05d\t%-14s\t%8d\n",
			(p + i)->id, (p + i)->name, (p + i)->purchase_price);
		}
	}
//****************************************************************************
}int main(void){
	Person member[] = {
		{   91, "玉江 カタル", "タマエ カタル",         20060813, 0},
		{  902, "榎本 剛",     "エノモト ツヨシ",       20050903, 0},
		{ 1903, "二神 龍太郎", "フタガミ リュウタロウ", 20070326, 0},
		{ 1904, "田中 良美",   "タナカ ヨシミ",         20080608, 0},
		{11905, "吉田 徹",     "ヨシダ トオル",         20090211, 0},
		{11906, "高橋 純",     "タカハシ ジュン",       20060704, 0},
		{11907, "今田 隆弘",   "イマダ タカヒロ",       20070823, 0},
		{11908, "鈴木 博",     "スズキ ヒロシ",         20080619, 0},
		{20012, "浦野 晶子",   "ウラノ ショウコ",       20091002, 0},
		{21301, "井上 篤志",   "イノウエ アツシ",       20040719, 0},
		{33002, "倉石 美鈴",   "クライシ ミスズ",       20080316, 0},
		{35039, "小野寺 健",   "オノデラ ケン",         20071224, 0},
		{37415, "山田 太朗",   "ヤマダ タロウ",         20080515, 0},
		{40653, "浜崎 静香",   "ハマサキ シズカ",       20061119, 0},
		{41063, "藤田 由貴",   "フジタ ユキ",           20051009, 0}
	};

	int sales_data[2][NUMBER] = {
			{11907,33002,1903,21301,33002,1903,41063,21301,11907,41063,
			1903,1903,41063,1903,21301}, //購入者ID
			{33400,72500,40200,10900,81200,86000,72000,18300,86000,74600,
			17700,89900,2400,44000,51100}
	}; //購入者idに対応する購入金額を二次元配列に格納

	Person *p = member; //構造体位置を示すポインタを宣言

	amount_summary(member, sales_data, p); //会員ごとの購入金額の集計
	print_data(member, p); //購入者のみ出力

	return EXIT_SUCCESS;
}

/*
購入者の一覧を表示します。

【会員データ】
 ID　　 氏名　　　　購入金額
 01903	二神 龍太郎	  277800
 11907	今田 隆弘 	  119400
 21301	井上 篤志 	   80300
 33002	倉石 美鈴 	  153700
 41063	藤田 由貴 	  149000

 */
